---
title: vue-routerå¯¼èˆªå®ˆå«
date: 2022-1-2
sidebar: 'auto'
categories:
 - Vue
tags:
 - vue-router
---
## å®ˆå«åˆ†ç±»ï¼ˆ3ç±»ï¼‰ï¼š
1.å…¨å±€å®ˆå«ï¼š	åœ¨è·¯ç”±é…ç½®ä¸Šå®šä¹‰
2.è·¯ç”±ç‹¬äº«å®ˆå«ï¼šåœ¨è·¯ç”±é…ç½®ä¸Šå®šä¹‰
3.ç»„ä»¶å†…å®ˆå«ï¼š	åœ¨ç»„ä»¶å†…éƒ¨å®šä¹‰
â€‹

## å…¨å±€å®ˆå«ï¼ˆ2ä¸ªå«å£«æŒæœ‰1æŠŠé’©å­ğŸªï¼‰ï¼š
### 1.beforeEachï¼šå…¨å±€å‰ç½®å®ˆå«ï¼Œæ¥å—ï¼ˆto,from,nextï¼‰3ä¸ªå‚æ•°
toè¡¨ç¤ºå¾€å“ªé‡Œå»
fromè¡¨ç¤ºå½“å‰è¦ç¦»å¼€åœ¨çš„è·¯ç”±
next()æ§åˆ¶æ”¾ä¸æ”¾è¡Œï¼Ÿï¼Œå¾€å“ªé‡Œæ”¾è¡Œï¼Ÿ
nextæœ‰4ç§æ–¹æ³•ï¼š
1.next()æ­¤å®ˆå«æ”¾è¡Œï¼Œä½†æ˜¯èƒ½ä¸èƒ½å»å¾€å…¶ä»–è·¯ç”±ï¼Œè¿˜è¦çœ‹åˆ«çš„å®ˆå«æ˜¯å¦ä¹Ÿæ”¾è¡Œã€‚
2.next(fasle)æ­¤å®ˆå«ä¸æ”¾è¡Œï¼Œå³ä¸­æ–­å½“å‰å¯¼èˆªï¼Œå³ä½¿ç”¨æˆ·æ‰‹åŠ¨ç‚¹å‡»åé€€æŒ‰é’®ä¹Ÿä¼šé‡ç½®åˆ°å½“å‰æ‰€åœ¨çš„è·¯ç”±ã€‚
3.next(' ')å¯ä»¥è‡ªå·±å¾€nextä¸­ä¼ é€’è·¯ç”±ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å†³å®šå®ˆå«å¾€å“ªé‡Œçš„è·¯ç”±æ”¾è¡Œã€‚
4.next(error) å¾€nextä¸­ä¼ é€’ä¸€ä¸ªErrorå®ä¾‹ï¼Œæ­¤å®ˆå«ä¸æ”¾è¡Œï¼Œä¸”errorä¼šè¢«ä¼ é€’ç»™router.onError()
```javascript
const router = new VueRouter({ ... })

router.beforeEach((to, from, next) => {
  // ...
})
```
æ³¨ï¼šnextåªèƒ½è¢«ä¸¥æ ¼è°ƒç”¨ä¸€æ¬¡ï¼Œé™¤éåœ¨if elseç­‰é€»è¾‘è·¯å¾„ä¸é‡å çš„æƒ…å†µä¸‹èƒ½è¢«è°ƒç”¨å¤šæ¬¡
### 2.beforeResolve:å…¨å±€è§£æå®ˆå«ï¼ˆto,from,nextï¼‰
ç”¨å¤„ï¼šåœ¨ beforeRouteEnter è°ƒç”¨ä¹‹åï¼Œå¯¼èˆªè¢«ç¡®è®¤ä¹‹å‰ï¼ŒåŒæ—¶åœ¨æ‰€æœ‰ç»„ä»¶å†…å®ˆå«å’Œå¼‚æ­¥è·¯ç”±ç»„ä»¶è¢«è§£æä¹‹åè°ƒç”¨
### 3.afterEachï¼šå…¨å±€åç½®é’©å­ï¼ˆto,fromï¼‰
å·²ç»è¿›å…¥ç›®æ ‡è·¯ç”±äº†ï¼Œæ‰€ä»¥æ²¡æœ‰nextï¼ˆï¼‰å‚æ•°ï¼Œ
ç”¨å¤„ï¼šç±»ä¼¼äºæ§åˆ¶è·³è½¬åæ»šåŠ¨æ¡å›åˆ°é¡¶éƒ¨
```javascript
router.afterEach((to, from) => {  
    // è·³è½¬ä¹‹åæ»šåŠ¨æ¡å›åˆ°é¡¶éƒ¨  
    window.scrollTo(0,0);
});
```


# è·¯ç”±ç‹¬äº«å®ˆå«
beforeEnter:å’ŒbeforeEachä¸€æ ·æ¥å—3ä¸ªå‚æ•°ï¼Œç›´æ¥åœ¨è·¯ç”±é…ç½®å¤„å®šä¹‰
```javascript
const router = new VueRouter({
  routes: [
    {
      path: '/foo',
      component: Foo,
      beforeEnter: (to, from, next) => {
        // ...
      }
    }
  ]
})
```


# ç»„ä»¶å†…å®ˆå«ï¼ˆ3ä¸ªï¼‰
å‡æ¥å—3ä¸ªå‚æ•°(to, from, next) 
### 1.beforeRouteEnter :		
1.æ— æ³•è·å–thisï¼Œå› ä¸ºæ­¤æ—¶ç»„ä»¶è¿˜æ²¡æœ‰è¢«åˆ›ç«‹ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å¾€nextä¼ å…¥å›è°ƒ
æ–¹å¼æ¥è®¿é—®thisï¼Œâš ï¸æ³¨æ„ï¼šbeforeRouteEnteræ˜¯å”¯ä¸€ä¸€ä¸ªå¯ä»¥å¾€nexté‡Œé¢ä¼ å…¥å›è°ƒçš„å®ˆå«ã€‚
2.åœ¨æ¸²æŸ“è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±è¢«confirm å‰è°ƒç”¨ã€‚
### 2.beforeRouteUpdateï¼š	
1.èƒ½è·å–this
                       2.å¯¹äºä¸€ä¸ªå¸¦æœ‰åŠ¨æ€å‚æ•°çš„è·¯å¾„ /foo/:idï¼Œåœ¨ /foo/1 å’Œ /foo/2 ä¹‹é—´è·³è½¬çš„æ—¶å€™ï¼Œç”±äºä¼šæ¸²æŸ“åŒæ ·çš„ Foo ç»„ä»¶ï¼Œå› æ­¤ç»„ä»¶å®ä¾‹ä¼šè¢«å¤ç”¨ã€‚è€Œè¿™ä¸ªé’©å­å°±ä¼šåœ¨è¿™ä¸ªæƒ…å†µä¸‹è¢«è°ƒç”¨ã€‚å³Fooç»„ä»¶è¢«å¤ç”¨æ—¶ï¼Œè°ƒç”¨beforeRouteUpdate
                       3.æ­¤é’©å­è°ƒç”¨åæ‰è°ƒç”¨beforeResolveå…¨å±€è§£æå®ˆå«ï¼Œå› ä¸ºåœ¨æ­¤ä¹‹å‰beforeRouteEnterç»„ä»¶è¿˜æ²¡æœ‰è¢«åˆ›å»ºï¼Œè€ŒbeforeResolveéœ€è¦ç»„ä»¶è¢«è§£æä¹‹åæ‰èƒ½è°ƒç”¨ã€‚
### 3.beforeRouteLeaveï¼š
1.å¯ä»¥è·å–thisï¼Œç¦»å¼€ç»„ä»¶æ—¶å€™å¯¹åº”è·¯ç”±æ—¶å€™ä½¿ç”¨ã€‚
2.ç”¨é€”ï¼šé€šå¸¸ç”¨æ¥ç¦æ­¢ç”¨æˆ·åœ¨è¿˜æœªä¿å­˜ä¿®æ”¹å‰çªç„¶ç¦»å¼€
```javascript
beforeRouteLeave (to, from, next) {
  const answer = window.confirm('Do you really want to leave? you have unsaved changes!')
  if (answer) {
    next()
  } else {
    next(false)
  }
}
```


## å®Œæ•´å¯¼èˆªè§£ææµç¨‹

1. å¯¼èˆªè¢«è§¦å‘ã€‚
1. åœ¨å¤±æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteLeave å®ˆå«ã€‚
1. è°ƒç”¨å…¨å±€çš„ beforeEach å®ˆå«ã€‚
1. åœ¨é‡ç”¨çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteUpdate å®ˆå«ã€‚
1. åœ¨è·¯ç”±é…ç½®é‡Œè°ƒç”¨ beforeEnterã€‚
1. è§£æå¼‚æ­¥è·¯ç”±ç»„ä»¶ã€‚
1. åœ¨è¢«æ¿€æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteEnterã€‚
1. è°ƒç”¨å…¨å±€çš„ beforeResolve å®ˆå« (2.5+)ã€‚
1. å¯¼èˆªè¢«ç¡®è®¤ã€‚
1. è°ƒç”¨å…¨å±€çš„ afterEach é’©å­ã€‚
1. è§¦å‘ DOM æ›´æ–°ã€‚
1. è°ƒç”¨ beforeRouteEnter å®ˆå«ä¸­ä¼ ç»™ next çš„å›è°ƒå‡½æ•°ï¼Œåˆ›å»ºå¥½çš„ç»„ä»¶å®ä¾‹ä¼šä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°ä¼ å…¥ã€‚

â€‹

å®˜æ–¹æ–‡æ¡£é“¾æ¥ï¼š[https://router.vuejs.org/zh/guide/advanced/navigation-guards.html](https://router.vuejs.org/zh/guide/advanced/navigation-guards.html)

